<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToraControl - Gestão de Estoque de Toras</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="libs/lucide.min.js"></script>
    <script src="libs/sweetalert2.all.min.js"></script>
    <script src="libs/jspdf.umd.min.js"></script>
    <script src="libs/jspdf-autotable.min.js"></script>
    <script src="libs/exceljs.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
        // Executa imediatamente antes de renderizar o resto da página
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-mode');
        }
    </script>
</head>

<body>

    <div class="wrapper">
        <nav id="sidebar">
            <div class="sidebar-header">
                <div class="logo-area">
                    <div class="logo-icon"><i data-lucide="zap"></i></div>
                    <span class="nav-text">MT <strong>PRÓ</strong></span>
                </div>
                <button class="btn-toggle-sidebar" onclick="toggleSidebar()">
                    <i data-lucide="chevron-left" id="icon-toggle"></i>
                </button>
            </div>

            <ul class="components">
                <li class="active" onclick="carregarTela('home', this)" data-tooltip="Dashboard">
                    <a href="#"><i data-lucide="layout-grid"></i> <span class="nav-text">Dashboard</span></a>
                </li>
                <li onclick="carregarTela('especies', this)" data-tooltip="Espécies">
                    <a href="#"><i data-lucide="leaf"></i> <span class="nav-text">Cadastro de Espécies</span></a>
                </li>
                <li onclick="carregarTela('lotes', this)" data-tooltip="Lotes">
                    <a href="#"><i data-lucide="layers"></i> <span class="nav-text">Cadastro de Lotes</span></a>
                </li>
                <li onclick="carregarTela('entradas', this)" data-tooltip="Entradas">
                    <a href="#"><i data-lucide="arrow-down-left"></i> <span class="nav-text">Entradas no
                            Estoque</span></a>
                </li>
                <li onclick="carregarTela('baixas', this)" data-tooltip="Baixas">
                    <a href="#"><i data-lucide="arrow-up-right"></i> <span class="nav-text">Baixas de Estoque</span></a>
                </li>
                <li onclick="carregarTela('estoque', this)" data-tooltip="Estoque">
                    <a href="#"><i data-lucide="database"></i> <span class="nav-text">Estoque Geral</span></a>
                </li>
                <li onclick="carregarTela('relatorios', this)" data-tooltip="Relatórios">
                    <a href="#"><i data-lucide="file-text"></i> <span class="nav-text">Relatórios Gerenciais</span></a>
                </li>
                <li onclick="carregarTela('logs', this)" data-tooltip="Logs">
                    <a href="#"><i data-lucide="scroll-text"></i> <span class="nav-text">Log de Sistemas</span></a>
                </li>
                <li onclick="carregarTela('configuracoes', this)" data-tooltip="Configurações">
                    <a href="#"><i data-lucide="settings"></i> <span class="nav-text">Configurações</span></a>
                </li>
            </ul>

            <div class="sidebar-footer">
                <a href="#" class="btn-sair" onclick="window.close()">
                    <i data-lucide="log-out"></i> <span class="nav-text">Sair</span>
                </a>
                <div class="dark-mode-toggle">
                    <i data-lucide="moon"></i> <span class="nav-text">Modo Escuro</span>
                </div>
            </div>
        </nav>

        <div id="content">
            <header class="main-header">
                <h2 id="view-title">Dashboard</h2>
                <div class="user-info">
                    <i data-lucide="user-circle"></i> <span>Operador de Pátio</span>
                </div>
            </header>

            <div id="dynamic-content">

                <div id="v-home" class="view active">
                    <div class="header-titles">
                        <h2 style="margin: 0; color: #1e293b; font-size: 1.8rem; font-weight: 700;">Painel de
                            Indicadores</h2>
                        <p style="margin: 5px 0 0 0; color: #64748b; font-size: 1rem;">Resumo operacional do pátio em
                            tempo real</p>
                    </div>

                    <div class="header-search" style="margin-top:20px">
                        <div style="position: relative; width: 320px;">
                            <i data-lucide="search"
                                style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); width: 18px; color: #94a3b8;"></i>
                            <input type="text" id="busca-global-numero" placeholder="Buscar Número..."
                                onblur="aplicarMascaraNumero(this)"
                                onkeyup="if(event.key === 'Enter') { aplicarMascaraNumero(this); buscarNumeroGlobal(); }"
                                maxlength="10"
                                style="width: 100%; padding: 12px 16px 12px 42px; border-radius: 10px; border: 1px solid #e2e8f0; background: #ffffff; box-shadow: 0 1px 2px rgba(0,0,0,0.05); outline: none; transition: all 0.2s; font-size: 0.95rem;">
                        </div>
                    </div>
                    <div class="dashboard-grid">
                        <div class="dash-card">
                            <div class="dash-icon" style="background: #dcfce7; color: #15803d;">
                                <i data-lucide="package"></i>
                            </div>
                            <div class="dash-info">
                                <span class="dash-label">Estoque Total</span>
                                <h3 id="dash-total-pecas">0</h3>
                                <p>Toras</p>
                            </div>
                        </div>

                        <div class="dash-card">
                            <div class="dash-icon" style="background: #e0f2fe; color: #0369a1;">
                                <i data-lucide="database"></i>
                            </div>
                            <div class="dash-info">
                                <span class="dash-label">Volume Geral</span>
                                <h3 id="dash-total-volume">0.000</h3>
                                <p>Metros Cúbicos (m³)</p>
                            </div>
                        </div>

                        <div class="dash-card">
                            <div class="dash-icon" style="background: #fef9c3; color: #a16207;">
                                <i data-lucide="activity"></i>
                            </div>
                            <div class="dash-info">
                                <span class="dash-label">Ações de Hoje</span>
                                <h3 id="dash-acoes-hoje">0</h3>
                                <p>Registros no Log</p>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-footer"
                        style="display: grid; grid-template-columns: 2fr 1.2fr; gap: 20px; margin-top: 30px;">

                        <div class="dash-table-container">
                            <h4>Últimas Toras Cadastradas</h4>
                            <table class="dash-table">
                                <thead>
                                    <tr>
                                        <th>Número</th>
                                        <th>Espécie</th>
                                        <th>Volume (m³)</th>
                                        <th class="text-right">Data Entrada</th>
                                    </tr>
                                </thead>
                                <tbody id="dash-lista-recente"></tbody>
                            </table>
                        </div>

                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <div class="dash-lotes-container">
                                <h4>Resumo por Lote</h4>
                                <div id="dash-lista-lotes"></div>
                            </div>
                            <div class="dash-lotes-container">
                                <h4>Ranking de Espécies</h4>
                                <div id="dash-ranking-especies"></div>
                            </div>
                            <div class="dash-lotes-container">
                                <h4>Atividades Recentes</h4>
                                <div id="dash-logs-recentes"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="v-entradas" class="view">
                    <div class="form-card" style="margin-bottom: 30px;">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="plus-circle"></i></div>
                            <div>
                                <h3>Nova Entrada de Tora</h3>
                                <p>Dê entrada de Toras nos seus Pátios</p>
                            </div>
                        </div>
                        <div class="form-body">
                            <input type="hidden" id="tora-id">

                            <div class="form-section-title">Identificação da Tora</div>
                            <div class="form-row">
                                <div class="input-container">
                                    <label>Código / Número</label>
                                    <input type="text" id="tora-codigo" class="custom-input"
                                        onblur="aplicarMascaraNumero(this)" maxlength="10"
                                        placeholder="Ex: 001 ou 1050">
                                </div>
                                <div class="input-container">
                                    <label>Espécie</label>
                                    <select id="tora-especie" class="custom-input"></select>
                                </div>
                                <div class="input-container">
                                    <label>Lote de Destino</label>
                                    <select id="tora-lote" class="custom-input"></select>
                                </div>
                            </div>

                            <div class="form-section-title">Medidas de Cubagem</div>
                            <div class="form-row" style="margin-top: 15px;">
                                <div class="input-container">
                                    <label>Rodo (cm)</label>
                                    <input type="number" id="rodo" oninput="calcularCubagem()"
                                        class="custom-input highlight-focus" placeholder="0">
                                </div>
                                <div class="input-container">
                                    <label>Comprimento (m)</label>
                                    <input type="text" id="comprimento"
                                        oninput="mascaraComprimento(this); calcularCubagem()"
                                        class="custom-input highlight-focus" placeholder="0,00">
                                </div>
                            </div>

                            <div class="form-section-title">Descontos (Oco)</div>
                            <div class="form-row" style="margin-top: 15px;">
                                <div class="input-container">
                                    <label>Desconto 1 (cm)</label>
                                    <input type="number" id="d1" oninput="calcularCubagem()"
                                        class="custom-input highlight-focus" placeholder="0">
                                </div>
                                <div class="input-container">
                                    <label>Desconto 2 (cm)</label>
                                    <input type="number" id="d2" oninput="calcularCubagem()"
                                        class="custom-input highlight-focus" placeholder="0">
                                </div>
                                <div class="input-container">
                                    <label>Tot. Desconto (m³)</label>
                                    <input type="text" id="total-desconto-ver" class="custom-input readonly-field"
                                        readonly placeholder="0,000" tabindex="-1">
                                </div>
                            </div>

                            <div class="result-panel">
                                <div class="result-info">
                                    <span>Volume Líquido Calculado</span>
                                    <h2 id="volume-result">0,000 m³</h2>
                                    <small id="detalhe-calculo" style="font-size: 10px; color: #e0dddd;"></small>
                                </div>
                                <div class="result-icon"><i data-lucide="calculator"></i></div>
                            </div>
                        </div>
                        <div class="form-footer">
                            <button class="btn-save" id="btn-salvar-tora" onclick="salvarTora()">
                                <i data-lucide="check"></i> <span>Confirmar Entrada</span>
                            </button>
                            <button class="btn-cancel" id="btn-cancelar-tora" style="display: none;"
                                onclick="resetFormEntrada()">
                                Cancelar Edição
                            </button>
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="history"></i></div>
                            <div>
                                <h3>Últimas Toras Registradas</h3>
                                <p>Histórico recente de entradas no pátio</p>
                            </div>
                        </div>
                        <div class="form-body" style="padding: 0;">
                            <table class="custom-table">
                                <thead>
                                    <tr>
                                        <th>Número</th>
                                        <th>Espécie</th>
                                        <th>Lote</th>
                                        <th>Rodo/Comp</th>
                                        <th>Oco (cm)</th>
                                        <th>Vol Líquido</th>
                                        <th style="text-align: right;">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-entradas-recentes"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="v-especies" class="view">
                    <div class="form-card" style="margin-bottom: 30px;">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="leaf"></i></div>
                            <div>
                                <h3>Cadastro de Espécies</h3>
                                <p>Adicione novas Espécies de madeira ao sistema</p>
                            </div>
                        </div>
                        <div class="form-body">
                            <div class="form-row">
                                <div class="input-container">
                                    <label>Nome Popular</label>
                                    <input type="text" id="esp-nome" class="custom-input" placeholder="Ex: Ipê">
                                </div>
                                <div class="input-container">
                                    <label>Nome Científico</label>
                                    <input type="text" id="esp-cientifico" class="custom-input"
                                        placeholder="Ex: Handroanthus">
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="esp-id">
                        <div class="form-footer">
                            <button class="btn-save" id="btn-salvar-especie" onclick="salvarEspecie()">
                                <i data-lucide="check"></i> <span>Salvar Espécie</span>
                            </button>
                            <button class="btn-cancel" id="btn-cancelar-esp" style="display: none;"
                                onclick="resetEspecieForm()">Cancelar Edição
                            </button>
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="list"></i></div>
                            <div>
                                <h3>Espécies Cadastradas</h3>
                                <p>Visualize e gerencie as espécies existentes</p>
                            </div>
                        </div>
                        <div class="form-body" style="padding: 0;">
                            <table class="custom-table">
                                <thead>
                                    <tr>
                                        <th>Nome Popular</th>
                                        <th>Nome Científico</th>
                                        <th style="text-align: right;">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-especies"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="v-lotes" class="view">
                    <div class="form-card" style="margin-bottom: 30px;">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="layers"></i></div>
                            <div>
                                <h3>Novo Lote</h3>
                                <p>Crie agrupamentos para organizar suas toras no pátio</p>
                            </div>
                        </div>
                        <div class="form-body">
                            <input type="hidden" id="lote-id">
                            <div class="form-row">
                                <div class="input-container">
                                    <label>Número do Lote</label>
                                    <input type="text" id="lote-numero" class="custom-input" placeholder="Ex: 001/2026">
                                </div>
                                <div class="input-container" style="grid-column: span 2;">
                                    <label>Descrição / Observação</label>
                                    <input type="text" id="lote-descricao" class="custom-input"
                                        placeholder="Ex: Lote destinado à exportação">
                                </div>
                            </div>
                        </div>
                        <div class="form-footer">
                            <button class="btn-save" id="btn-salvar-lote" onclick="salvarLote()">
                                <i data-lucide="save"></i> <span>Salvar Lote</span>
                            </button>
                            <button class="btn-cancel" id="btn-cancelar-edicao" style="display: none;"
                                onclick="resetLoteForm()">
                                Cancelar Edição
                            </button>
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="table"></i></div>
                            <div>
                                <h3>Lotes Ativos</h3>
                                <p>Lista de lotes disponíveis para armazenamento</p>
                            </div>
                        </div>
                        <div class="form-body" style="padding: 0;">
                            <table class="custom-table">
                                <thead>
                                    <tr>
                                        <th>Número do Lote</th>
                                        <th>Descrição</th>
                                        <th style="text-align: center;">Qtd Toras</th>
                                        <th style="text-align: center;">Volume Total</th>
                                        <th style="text-align: right;">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-lotes"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="v-baixas" class="view">
                    <div class="form-card">
                        <div class="form-header">
                            <div class="header-icon" style="background: #fff1f2; color: #e11d48;"><i
                                    data-lucide="arrow-up-right"></i></div>
                            <div>
                                <h3>Baixa de Estoque / Romaneio</h3>
                                <p>Selecione os números para saída do pátio</p>
                            </div>
                        </div>

                        <div class="form-body">
                            <div class="form-row" style="margin-bottom: 20px;">
                                <div class="input-container">
                                    <label>Data da Saída</label>
                                    <input type="date" id="saida-data" class="custom-input">
                                </div>
                                <div class="input-container" style="grid-column: span 2;">
                                    <label>Adicionar Número</label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="text" id="buscar-tora-codigo" class="custom-input"
                                            placeholder="Digite o Número (Ex: 001)" maxlength="10"
                                            onblur="aplicarMascaraNumero(this)"
                                            onkeyup="if(event.key==='Enter') { aplicarMascaraNumero(this); buscarEAdicionarALista(); }">

                                        <button class="btn-save" onclick="buscarEAdicionarALista()">
                                            <i data-lucide="plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <table class="custom-table">
                                <thead>
                                    <tr>
                                        <th>Número</th>
                                        <th>Espécie</th>
                                        <th>Lote</th>
                                        <th>Medidas</th>
                                        <th>Volume (m³)</th>
                                        <th style="text-align: right;">Ação</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-baixa-temporaria"></tbody>
                            </table>

                            <div class="result-panel"
                                style="margin-top: 20px; background: #f8fafc; border: 1px dashed #cbd5e1;">
                                <div class="result-info">
                                    <span style="color: #64748b;">Resumo do Romaneio</span>
                                    <h2 id="total-volume-baixa" style="color: #1e293b;">0,000 m³</h2>
                                    <p id="total-toras-baixa"
                                        style="font-size: 14px; font-weight: 600; color: #6366f1;">0 Toras selecionadas
                                    </p>
                                </div>
                                <div class="result-icon"><i data-lucide="file-text"></i></div>
                            </div>
                        </div>
                        <div class="form-footer">
                            <button class="btn-save" style="background: #10b981;" onclick="processarBaixaEGerarPDF()">
                                <i data-lucide="file-check"></i> Finalizar e Gerar PDF
                            </button>
                            <button class="btn-cancel" onclick="limparListaTemporaria()" style="display: block;">
                                <i data-lucide="refresh-cw"></i> Limpar Lista
                            </button>
                        </div>
                    </div>
                </div>

                <div id="v-estoque" class="view">
                    <div class="form-card">
                        <div class="form-header"
                            style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div class="header-icon" style="background: #e0e7ff; color: #6366f1;">
                                    <i data-lucide="database"></i>
                                </div>
                                <div>
                                    <h3>Controle de Estoque Geral</h3>
                                    <p>Monitore o saldo das toras no pátio e o histórico de baixas</p>
                                </div>
                            </div>
                            <button class="btn-save" onclick="carregarTela('entradas')"
                                style="display: flex; align-items: center; gap: 10px; padding: 10px 20px; border-radius: 8px; font-weight: 600;">
                                <i data-lucide="plus-circle" style="width: 18px; height: 18px;"></i>
                                Cadastrar Tora
                            </button>
                        </div>

                        <div class="form-body">
                            <div class="form-row" style="margin-bottom: 25px;">
                                <div class="input-container"
                                    style="background: #f8fafc; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0;">
                                    <label
                                        style="color: #64748b; font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em;">Total
                                        de Toras</label>
                                    <div id="indicador-qtd-patio"
                                        style="font-size: 28px; font-weight: 800; color: #6366f1;">0</div>
                                </div>
                                <div class="input-container"
                                    style="background: #f8fafc; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0;">
                                    <label
                                        style="color: #64748b; font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em;">Volume
                                        em Pátio (m³)</label>
                                    <div id="indicador-vol-patio"
                                        style="font-size: 28px; font-weight: 800; color: #10b981;">0,000</div>
                                </div>
                            </div>

                            <div class="form-section-title">Filtros de Consulta</div>
                            <div class="filtros-estoque">
                                <div>
                                    <label>Status:</label>
                                    <select id="filtro-estoque-status" class="custom-input"
                                        onchange="carregarEstoque(true)">
                                        <option value="pátio">No Pátio (Disponível)</option>
                                        <option value="serrada">Serradas (Baixadas)</option>
                                        <option value="todos">Todas as Toras</option>
                                    </select>
                                </div>
                                <div>
                                    <label>Lote:</label>
                                    <select id="filtro-estoque-lote" class="custom-input"
                                        onchange="carregarEstoque(true)">
                                        <option value="todos">Todos os Lotes</option>
                                    </select>
                                </div>
                                <div>
                                    <label>Número:</label>
                                    <input type="text" id="filtro-estoque-codigo" class="custom-input"
                                        placeholder="Digite e aperte Enter..." maxlength="10"
                                        onblur="aplicarMascaraNumero(this)"
                                        onkeyup="if(event.key==='Enter') { aplicarMascaraNumero(this); carregarEstoque(true); }">
                                </div>
                                <div style="display: flex; align-items: flex-end;">
                                    <button class="btn-save" onclick="carregarEstoque(true)" title="Atualizar">
                                        <i data-lucide="refresh-ccw"
                                            style="width: 20px; height: 20px; color: white;"></i>
                                    </button>
                                </div>
                            </div>

                            <table class="custom-table">
                                <thead>
                                    <tr>
                                        <th>Número</th>
                                        <th>Espécie</th>
                                        <th>Lote</th>
                                        <th>Medidas (R/C/O)</th>
                                        <th>Volume (m³)</th>
                                        <th>Status</th>
                                        <th>Data Entrada</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-estoque-corpo"></tbody>
                            </table>
                            <div class="container-acoes-tabela">
                                <button id="btn-carregar-mais" class="btn-carregar-mais" onclick="carregarEstoque()">
                                    <i data-lucide="refresh-cw"></i>
                                    Carregar mais toras...
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="v-relatorios" class="view">
                    <div class="form-card" style="margin-bottom: 30px;">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="bar-chart-3"></i></div>
                            <div>
                                <h3>Relatórios Gerenciais</h3>
                                <p>Filtros avançados para exportação de dados e conferência de seu Estoque</p>
                            </div>
                        </div>

                        <div class="form-body">
                            <div class="form-section-title">Parâmetros do Relatório</div>
                            <div class="form-row">
                                <div class="input-container">
                                    <label>Tipo de Relatório</label>
                                    <select id="rel-tipo" class="custom-input">
                                        <option value="geral">Relatório Geral (Todo Histórico)</option>
                                        <option value="baixas">Relatório de Baixas (Saídas)</option>
                                        <option value="entradas">Relatório de Entradas</option>
                                        <option value="estoque">Inventário Atual (Saldo)</option>
                                    </select>
                                </div>
                                <div class="input-container">
                                    <label>Data Início</label>
                                    <input type="date" id="rel-data-inicio" class="custom-input">
                                </div>
                                <div class="input-container">
                                    <label>Data Fim</label>
                                    <input type="date" id="rel-data-fim" class="custom-input">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="input-container">
                                    <label>Espécie</label>
                                    <select id="rel-especie" class="custom-input">
                                        <option value="todas">Todas as Espécies</option>
                                    </select>
                                </div>
                                <div class="input-container">
                                    <label>Lote</label>
                                    <select id="rel-lote" class="custom-input">
                                        <option value="todos">Todos os Lotes</option>
                                    </select>
                                </div>
                                <div class="input-container"></div>
                            </div>

                            <div class="result-panel" style="margin-top: 20px;">
                                <div class="result-info">
                                    <span>Volume Total Filtrado</span>
                                    <h2 id="rel-total-vol">0,000 m³</h2>
                                    <small id="rel-total-qtd">0 toras encontradas</small>
                                </div>
                                <div class="result-icon"><i data-lucide="layers"></i></div>
                            </div>
                        </div>

                        <div class="form-footer">
                            <button class="btn-save" onclick="gerarPreviaRelatorio()" style="background: #6366f1;">
                                <i data-lucide="eye"></i> <span>Visualizar</span>
                            </button>

                            <button class="btn-save" onclick="exportarRelatorioPDF()" style="background: #ef4444;">
                                <i data-lucide="file-text"></i> <span>PDF</span>
                            </button>

                            <button class="btn-save" onclick="exportarRelatorioExcel()" style="background: #10b981;">
                                <i data-lucide="sheet"></i> <span>Excel</span>
                            </button>

                            <button class="btn-cancel" onclick="limparFiltrosRelatorio()"
                                style="display: block; margin-left: auto;">
                                Limpar Filtros
                            </button>
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="table"></i></div>
                            <div>
                                <h3>Pré-visualização dos Dados</h3>
                                <p>Resultado da busca baseada nos filtros aplicados acima</p>
                            </div>
                        </div>
                        <div class="form-body" style="padding: 0;">
                            <table class="custom-table">
                                <thead>
                                    <tr>
                                        <th style="width: 10%;">Número</th>
                                        <th style="width: 20%;">Espécie</th>
                                        <th style="width: 20%;">Lote</th>
                                        <th style="width: 20%; text-align: center;">Medidas (cm x m)</th>
                                        <th style="width: 15%; text-align: center;">Volume (m³)</th>
                                        <th style="width: 15%; text-align: right; padding-right: 20px;">Entrada / Saída
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="rel-tabela-corpo">
                                    <tr>
                                        <td colspan="6" style="text-align: center; padding: 40px; color: #94a3b8;">
                                            <i data-lucide="info"
                                                style="display: inline-block; vertical-align: middle; margin-right: 8px;"></i>
                                            Ajuste os filtros e clique em "Visualizar" para carregar os dados.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div id="container-btn-rel-mais"
                                style="display: flex; justify-content: center; width: 100%; margin-top: 30px; margin-bottom: 50px;">
                                <button id="btn-rel-carregar-mais" class="btn-carregar-mais"
                                    style="display: none; min-width: 300px;" onclick="gerarPreviaRelatorio(false)">
                                    <i data-lucide="refresh-cw"></i> Carregar mais registros...
                                </button>
                            </div>
                        </div>
                    </div>
                    <div id="container-resumos" style="margin-bottom: 30px;"></div>
                </div>

                <div id="v-logs" class="view">
                    <div class="form-card">
                        <div class="form-header">
                            <div class="header-icon" style="background: #f1f5f9; color: #475569;">
                                <i data-lucide="scroll-text"></i>
                            </div>
                            <div>
                                <h3>Log de Sistemas</h3>
                                <p>Rastreamento de atividades e alterações no inventário</p>
                            </div>
                        </div>
                        <div class="form-body">
                            <div class="filtros-estoque"
                                style="display: grid; grid-template-columns: 1.5fr 1fr 1fr auto; gap: 10px; background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                                <div>
                                    <label>Ação:</label>
                                    <select id="log-filtro-acao" class="custom-input">
                                        <option value="todos">Todas as ações</option>
                                        <option value="ENTRADA">Entradas de Toras</option>
                                        <option value="EDICAO">Edições de Toras</option>
                                        <option value="BAIXA">Baixas/Romaneio</option>
                                        <option value="LOTE">Cadastro de Lotes</option>
                                        <option value="EXCLUSAO">Exclusões</option>
                                    </select>
                                </div>
                                <div>
                                    <label>Início:</label>
                                    <input type="date" id="input-filtro-data-inicio-logs" class="custom-input">
                                </div>
                                <div>
                                    <label>Fim:</label>
                                    <input type="date" id="input-filtro-data-fim-logs" class="custom-input">
                                </div>
                                <div style="display: flex; align-items: flex-end; gap: 5px;">
                                    <button onclick="carregarLogs()" class="btn-save"
                                        style="background: #64748b; height: 42px;">
                                        <i data-lucide="search"></i>
                                    </button>
                                    <button onclick="limparFiltrosLogs()" class="btn-save"
                                        style="background: #cbd5e1; color: #475569; height: 42px;">
                                        <i data-lucide="refresh-cw"></i>
                                    </button>
                                    <button type="button" onclick="exportarLogsPDF()" class="btn-save"
                                        style="background: #0f172a; height: 42px;">
                                        <i data-lucide="file-text"></i> Exportar PDF
                                    </button>
                                </div>
                            </div>

                            <table class="custom-table">
                                <thead>
                                    <tr>
                                        <th style="width: 160px;">Data/Hora</th>
                                        <th style="width: 120px;">Usuário</th>
                                        <th style="width: 100px;">Ação</th>
                                        <th>Descrição</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-logs">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="v-ativacao" class="view">
                    <div class="form-card" style="max-width: 500px; margin: 50px auto;">
                        <div class="form-header">
                            <div class="header-icon"><i data-lucide="shield-check"></i></div>
                            <div>
                                <h2>Ativação do Sistema</h2>
                                <p>O software ainda não foi ativado nesta máquina.</p>
                            </div>
                        </div>
                        <div class="form-body">
                            <div class="input-container">
                                <label>ID desta Máquina (Envie ao Administrador):</label>
                                <input type="text" id="machine-id-display" class="custom-input" readonly>
                            </div>
                            <br>
                            <div class="input-container">
                                <label>Insira sua Chave de Licença:</label>
                                <input type="text" id="license-key-input" class="custom-input"
                                    placeholder="XXXX-XXXX-XXXX">
                            </div>
                        </div>
                        <div class="form-footer">
                            <button id="btn-activar" class="btn-save">Ativar Agora</button>
                        </div>
                    </div>
                </div>

                <div id="v-configuracoes" class="view">
                    <div class="form-card" style="margin-bottom: 20px; border-top: 4px solid #6366f1;">
                        <div class="form-header">
                            <div class="header-icon" style="background: #e0e7ff; color: #6366f1;"><i
                                    data-lucide="database"></i></div>
                            <div>
                                <h3>Segurança dos Dados</h3>
                                <p>Exportar cópia de segurança do inventário</p>
                            </div>
                        </div>
                        <div class="form-body">
                            <div
                                style="display: flex; align-items: center; justify-content: space-between; padding: 20px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                                <div>
                                    <h4 style="color: #1e293b; margin-bottom: 5px;">Gerar Backup (.db)</h4>
                                    <p style="color: #64748b; font-size: 13px;">Crie uma cópia completa de todas as suas
                                        toras, espécies e lotes.</p>
                                </div>
                                <button class="btn-save" onclick="fazerBackup()"
                                    style="width: auto; padding: 10px 25px;"><i data-lucide="download"></i> Salvar
                                    Backup</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-card" style="border-top: 4px solid #f87171;">
                        <div class="form-header">
                            <div class="header-icon" style="background: #fee2e2; color: #ef4444;"><i
                                    data-lucide="alert-triangle"></i></div>
                            <div>
                                <h3>Zona de Perigo</h3>
                                <p>Gerenciamento e manutenção do banco de dados</p>
                            </div>
                        </div>
                        <div class="form-body">
                            <div
                                style="display: flex; align-items: center; justify-content: space-between; padding: 20px; background: #fff5f5; border-radius: 8px; border: 1px solid #fecaca;">
                                <div>
                                    <h4 style="color: #991b1b; margin-bottom: 5px;">Resetar Banco de Dados</h4>
                                    <p style="color: #b91c1c; font-size: 13px;">Apaga permanentemente todos os registros
                                        do sistema.</p>
                                </div>
                                <button class="btn-cancel" onclick="resetarSistemaCompleto()"
                                    style="background: #ef4444; color: white; border: none; padding: 10px 20px;">
                                    <i data-lucide="trash-2"></i> Resetar Tudo
                                </button>
                            </div>
                        </div>

                        <div class="form-footer" style="background: #f8fafc; font-size: 12px; color: #64748b;">
                            ToraControl v1.0.0 | Status: Conectado
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>

</html>